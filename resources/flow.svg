<svg id="mermaid-svg" width="100%" xmlns="http://www.w3.org/2000/svg" style="background: #fff;max-width: 1884.796875px;" viewBox="-8 -8 1884.796875 925.75" role="graphics-document document" aria-roledescription="flowchart-v2" xmlns:xlink="http://www.w3.org/1999/xlink"><style>#mermaid-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg .error-icon{fill:#552222;}#mermaid-svg .error-text{fill:#552222;stroke:#552222;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:#333333;stroke:#333333;}#mermaid-svg .marker.cross{stroke:#333333;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg .cluster-label text{fill:#333;}#mermaid-svg .cluster-label span{color:#333;}#mermaid-svg .label text,#mermaid-svg span{fill:#333;color:#333;}#mermaid-svg .node rect,#mermaid-svg .node circle,#mermaid-svg .node ellipse,#mermaid-svg .node polygon,#mermaid-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg .node .label{text-align:center;}#mermaid-svg .node.clickable{cursor:pointer;}#mermaid-svg .arrowheadPath{fill:#333333;}#mermaid-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg .cluster text{fill:#333;}#mermaid-svg .cluster span{color:#333;}#mermaid-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg .input&gt;*{fill:lightyellow!important;stroke:#FF0000!important;stroke-width:4px!important;}#mermaid-svg .input span{fill:lightyellow!important;stroke:#FF0000!important;stroke-width:4px!important;}#mermaid-svg .output&gt;*{fill:lightgreen!important;stroke:#0000FF!important;stroke-width:4px!important;}#mermaid-svg .output span{fill:lightgreen!important;stroke:#0000FF!important;stroke-width:4px!important;}#mermaid-svg .loss&gt;*{fill:cyan!important;stroke:orange!important;stroke-width:4px!important;}#mermaid-svg .loss span{fill:cyan!important;stroke:orange!important;stroke-width:4px!important;}</style><g><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 12 20" refX="10" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"><g class="cluster default" id="Training"><rect style="" rx="0" ry="0" x="0" y="520" width="1868.796875" height="389.75"></rect><g class="cluster-label" transform="translate(906, 520)"><foreignObject width="56.796875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Training</span></div></foreignObject></g></g><g class="cluster default" id="GT"><rect style="" rx="0" ry="0" x="0" y="0" width="1041.765625" height="500"></rect><g class="cluster-label" transform="translate(510.828125, 0)"><foreignObject width="20.109375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">GT</span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M228.828125,109L245.86197916666666,109C262.8958333333333,109,296.9635416666667,109,333.76816001201314,133.625C370.5727783573596,158.25,410.11430671471925,207.5,429.885070893399,232.125L449.6558350720789,256.75" id="L-A1-B-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A1 LE-B" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M306.03125,278.5L310.1979166666667,278.5C314.3645833333333,278.5,322.6979166666667,278.5,332.0091145833333,278.31525751579943C341.3203125,278.13051503159886,351.609375,277.76103006319767,356.75390625,277.5762875789971L361.8984375,277.3915450947965" id="L-A2-B-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A2 LE-B" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M284.2890625,419.5L292.0794270833333,419.5C299.8697916666667,419.5,315.4505208333333,419.5,342.7151050600343,398.0416666666667C369.97968928673527,376.5833333333333,408.92812857347053,333.6666666666667,428.40234821683816,312.2083333333333L447.87656786020585,290.75" id="L-A3-B-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A3 LE-B" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M564.7109375,273.75L585.3958333333334,273.75C606.0807291666666,273.75,647.4505208333334,273.75,687.8424479166666,273.75C728.234375,273.75,767.6484375,273.75,787.35546875,273.75L807.0625,273.75" id="L-B-C-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M228.828125,750L245.86197916666666,750C262.8958333333333,750,296.9635416666667,750,318.1640625,750C339.3645833333333,750,347.6979166666667,750,351.8645833333333,750L356.03125,750" id="L-A4-D-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A4 LE-D" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M1525.28125,686.8177466997302L1516.1184895833333,690.0147889164418C1506.9557291666667,693.2118311331534,1488.6302083333333,699.6059155665768,1443.3411458333333,702.8029577832884C1398.0520833333333,706,1325.7994791666667,706,1258.54296875,706C1191.2864583333333,706,1129.0260416666667,706,1093.7291666666667,706C1058.4322916666667,706,1050.0989583333333,706,1024.2903645833333,706C998.4817708333334,706,955.1979166666666,706,896.3736979166666,706C837.5494791666666,706,763.1848958333334,706,702.938506155303,710.5C642.6921164772727,715,596.5639204545455,724,573.4998224431819,728.5L550.4357244318182,733" id="L-A5-D-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A5 LE-D" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M1565.765625,832.2877525344613L1549.85546875,835.2397937787177C1533.9453125,838.1918350229743,1502.125,844.0959175114871,1450.0885416666667,847.0479587557435C1398.0520833333333,850,1325.7994791666667,850,1258.54296875,850C1191.2864583333333,850,1129.0260416666667,850,1093.7291666666667,850C1058.4322916666667,850,1050.0989583333333,850,1024.2903645833333,850C998.4817708333334,850,955.1979166666666,850,896.3736979166666,850C837.5494791666666,850,763.1848958333334,850,694.8062760416666,836.1666666666666C626.42765625,822.3333333333334,564.035,794.6666666666666,532.8386718749999,780.8333333333334L501.64234375,767" id="L-A6-D-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-A6 LE-D" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M499.6436981635071,733L531.1731338862559,718.25C562.7025696090047,703.5,625.7614410545024,674,676.9979080272511,659.25C728.234375,644.5,767.6484375,644.5,787.35546875,644.5L807.0625,644.5" id="L-D-E-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M1016.765625,273.75L1020.9322916666666,273.75C1025.0989583333333,273.75,1033.4322916666667,273.75,1041.765625,273.75C1050.0989583333333,273.75,1058.4322916666667,273.75,1066.765625,273.75C1075.0989583333333,273.75,1083.4322916666667,273.75,1087.5989583333333,273.75L1091.765625,273.75" id="L-C-F-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-F" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M1016.765625,644.5L1020.9322916666666,644.5C1025.0989583333333,644.5,1033.4322916666667,644.5,1041.765625,644.5C1050.0989583333333,644.5,1058.4322916666667,644.5,1091.5040809732525,587.125C1124.5758702798382,529.75,1182.3861155596762,415,1211.2912381995955,357.625L1240.1963608395145,300.25" id="L-E-F-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-F" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M1272.0314511263073,300.25L1305.0769905219229,347.625C1338.1225299175383,395,1404.2136087087692,489.75,1446.4219085210514,539.1244879415555C1488.6302083333333,588.4989758831108,1506.9557291666667,592.4979517662217,1516.1184895833333,594.4974397077772L1525.28125,596.4969276493326" id="L-F-A5-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-A5" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M1265.9866844883595,300.25L1300.0396849902997,372.7916666666667C1334.0926854922398,445.3333333333333,1402.19868649612,590.4166666666666,1452.16184324806,668.5096561763061C1502.125,746.6026456859455,1533.9453125,757.7052913718911,1549.85546875,763.2566142148639L1565.765625,768.8079370578367" id="L-F-A6-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-A6" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(688.8203125, 273.75)"><g class="label" transform="translate(-74.8984375, -9.5)"><foreignObject width="149.796875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Generate GT Surface</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(688.8203125, 644.5)"><g class="label" transform="translate(-93.2421875, -9.5)"><foreignObject width="186.484375" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Generate Training Surface</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1470.3046875, 584.5)"><g class="label" transform="translate(-29.9765625, -9.5)"><foreignObject width="59.953125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">gradient</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1470.3046875, 735.5)"><g class="label" transform="translate(-29.9765625, -9.5)"><foreignObject width="59.953125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">gradient</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-D-53" transform="translate(463.3046875, 750)"><rect class="basic label-container" style="" rx="5" ry="5" x="-107.2734375" y="-17" width="214.546875" height="34"></rect><g class="label" style="" transform="translate(-99.7734375, -9.5)"><foreignObject width="199.546875" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">SurfEval(NURBS.nurbs_eval)</span></div></foreignObject></g></g><g class="node default input" id="flowchart-A4-52" transform="translate(165.515625, 750)"><rect class="basic label-container" style="" rx="0" ry="0" x="-63.3125" y="-74" width="126.625" height="148"></rect><g class="label" style="" transform="translate(-55.8125, -66.5)"><foreignObject width="111.625" height="133"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">num_ctrl_pts_u<br/>        num_ctrl_pts_v<br/>        degree_v<br/>        degree_u<br/>        out_dim_u<br/>        out_dim_v<br/>        dimension=3</span></div></foreignObject></g></g><g class="node default input" id="flowchart-A5-54" transform="translate(1684.5390625, 631.25)"><rect class="basic label-container" style="" rx="0" ry="0" x="-159.2578125" y="-64.5" width="318.515625" height="129"></rect><g class="label" style="" transform="translate(-151.7578125, -57)"><foreignObject width="303.515625" height="114"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">ctrpts <br/><font color="#00FF00">initilize to vector with normal distribution</font><br/><font color="#FF0000">num_ctrl_pts_u x num_ctrl_pts_v x 3</font> <br/>        weight<br/><font color="#00FF00">initilize to tensor.ones()</font><br/><font color="#FF0000">num_ctrl_pts_u x num_ctrl_pts_v x 1</font></span></div></foreignObject></g></g><g class="node default input" id="flowchart-A6-56" transform="translate(1684.5390625, 810.25)"><rect class="basic label-container" style="" rx="0" ry="0" x="-118.7734375" y="-64.5" width="237.546875" height="129"></rect><g class="label" style="" transform="translate(-111.2734375, -57)"><foreignObject width="222.546875" height="114"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">knot_u<br/><font color="#00FF00">initilize to tensor.ones()</font><br/><font color="#FF0000">num_ctrl_pts_u + 1 + degree_u</font><br/>        knot_v<br/><font color="#00FF00">initilize to tensor.ones()</font><br/><font color="#FF0000">num_ctrl_pts_v + 1 + degree_v</font></span></div></foreignObject></g></g><g class="node default output" id="flowchart-E-59" transform="translate(911.9140625, 644.5)"><rect class="basic label-container" style="" rx="5" ry="5" x="-104.8515625" y="-26.5" width="209.703125" height="53"></rect><g class="label" style="" transform="translate(-97.3515625, -19)"><foreignObject width="194.703125" height="38"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Training Surface<br/><font color="#FF0000">out_dim_u x out_dim_v x 3</font></span></div></foreignObject></g></g><g class="node default default" id="flowchart-B-45" transform="translate(463.3046875, 273.75)"><rect class="basic label-container" style="" rx="5" ry="5" x="-101.40625" y="-17" width="202.8125" height="34"></rect><g class="label" style="" transform="translate(-93.90625, -9.5)"><foreignObject width="187.8125" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">SurfEval(NURBS.surf_eval)</span></div></foreignObject></g></g><g class="node default input" id="flowchart-A1-44" transform="translate(165.515625, 109)"><rect class="basic label-container" style="" rx="0" ry="0" x="-63.3125" y="-74" width="126.625" height="148"></rect><g class="label" style="" transform="translate(-55.8125, -66.5)"><foreignObject width="111.625" height="133"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">num_ctrl_pts_u<br/>        num_ctrl_pts_v<br/>        degree_v<br/>        degree_u<br/>        out_dim_u<br/>        out_dim_v<br/>        dimension=3</span></div></foreignObject></g></g><g class="node default input" id="flowchart-A2-46" transform="translate(165.515625, 278.5)"><rect class="basic label-container" style="" rx="0" ry="0" x="-140.515625" y="-45.5" width="281.03125" height="91"></rect><g class="label" style="" transform="translate(-133.015625, -38)"><foreignObject width="266.03125" height="76"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">ctrpts<br/><font color="#FF0000">num_ctrl_pts_u x num_ctrl_pts_v x 3</font><br/>        weight<br/><font color="#FF0000">num_ctrl_pts_u x num_ctrl_pts_v x 1</font></span></div></foreignObject></g></g><g class="node default input" id="flowchart-A3-48" transform="translate(165.515625, 419.5)"><rect class="basic label-container" style="" rx="0" ry="0" x="-118.7734375" y="-45.5" width="237.546875" height="91"></rect><g class="label" style="" transform="translate(-111.2734375, -38)"><foreignObject width="222.546875" height="76"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">knot_u<br/><font color="#FF0000">num_ctrl_pts_u + 1 + degree_u</font><br/>        knot_v<br/><font color="#FF0000">num_ctrl_pts_v + 1 + degree_v</font></span></div></foreignObject></g></g><g class="node default output" id="flowchart-C-51" transform="translate(911.9140625, 273.75)"><rect class="basic label-container" style="" rx="5" ry="5" x="-104.8515625" y="-26.5" width="209.703125" height="53"></rect><g class="label" style="" transform="translate(-97.3515625, -19)"><foreignObject width="194.703125" height="38"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">GT Surface<br/><font color="#FF0000">out_dim_u x out_dim_v x 3</font></span></div></foreignObject></g></g><g class="node default loss" id="flowchart-F-62" transform="translate(1253.546875, 273.75)"><rect class="basic label-container" style="" rx="5" ry="5" x="-161.78125" y="-26.5" width="323.5625" height="53"></rect><g class="label" style="" transform="translate(-154.28125, -19)"><foreignObject width="308.5625" height="38"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Loss<br/> mean square/hausdorff/chamfer/laplacian</span></div></foreignObject></g></g></g></g></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg>